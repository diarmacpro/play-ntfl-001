# Laporan Perubahan Kode pada `new_index.php`

## Deskripsi
Perubahan dilakukan pada file `new_index.php` untuk membatasi aksi tombol pada detail Surat Jalan (SJ) agar hanya proses ACC Manager yang dapat dijalankan. Selain itu, dilakukan penyesuaian tampilan dan interaksi tombol agar user mengetahui tombol lain tidak dapat digunakan (disabled dan tidak bisa diklik).

## Tujuan
- Memastikan hanya proses ACC Manager yang dapat dijalankan dari halaman ini.
- Membuat tombol lain (Proses WH, ACC Finish, Finish) selalu dalam keadaan disabled dan tidak dapat diklik.
- Memberikan feedback visual pada tombol yang tidak aktif agar user memahami tombol tersebut tidak bisa digunakan.
- Menyesuaikan endpoint API untuk proses ACC Manager.

---

## Before (Sebelum Perubahan)

- Tombol aksi dapat digunakan untuk beberapa status, termasuk ACC Finish dan Proses WH.
- Tombol yang disabled masih tampak seperti tombol aktif (tidak ada perubahan kursor atau transparansi).
- Endpoint API yang digunakan untuk update status adalah:
    ```javascript
    url: `../act.php?updateStatusBayar=${dx['id_sj']},${idPic}`
    ```

---

## After (Setelah Perubahan)

- Tombol aksi hanya aktif untuk status ACC Manager (`stts === '-'`). Untuk status lain, tombol otomatis disabled, tidak bisa diklik, kursor berubah menjadi `not-allowed`, dan tombol tampak transparan.
- Endpoint API untuk ACC Manager diganti menjadi:
    ```javascript
    url: `https://app.weva.my.id/api/acc-mg?id_sj=${dx['id_sj']}&id_m=${idPic}`
    ```
- Event click dihapus dari tombol untuk status selain ACC Manager.

---

## Potongan Kode & Penjelasan

### Sebelum

```javascript
if (stts === '-') {
  $('#btnAksi').prop('disabled', false).show();
  // ...existing code...
} else {
  $('#btnAksi').prop('disabled', true).show();
  // ...existing code...
}
```
**Penjelasan:**  
Tombol hanya di-disable, namun tidak ada perubahan visual yang jelas dan event click masih bisa saja terpasang.

---

### Sesudah

```javascript
if (stts === '-') {
  // Aktifkan tombol hanya untuk Acc Manager
  $('#btnAksi').prop('disabled', false)
    .css({'cursor':'pointer', 'opacity':'1'})
    .show();
  $('#btnAksi').off('click').on('click', function(){ btnAksiPlay(this); });
  // ...existing code...
} else {
  // Nonaktifkan tombol dan hilangkan event click untuk status lain
  $('#btnAksi').prop('disabled', true)
    .css({'cursor':'not-allowed', 'opacity':'0.6'})
    .show();
  $('#btnAksi').off('click');
  // ...existing code...
}
```
**Penjelasan:**  
- Tombol selain ACC Manager akan tampak transparan dan kursor berubah menjadi `not-allowed`.
- Event click dihapus sehingga benar-benar tidak bisa diklik.
- Tombol ACC Manager tetap aktif dan interaktif.

---

## Tindakan

- Refactor fungsi `btnAksiOlahElement` untuk mengatur status tombol dan event click.
- Menambahkan pengaturan CSS pada tombol untuk feedback visual (cursor dan opacity).
- Memastikan hanya status ACC Manager yang dapat menjalankan aksi.
- Mengganti endpoint API pada proses ACC Manager.

---

## Hasil / Kesimpulan

- Hanya proses ACC Manager yang dapat dijalankan dari halaman ini.
- Tombol lain selalu disabled, tidak bisa diklik, dan tampilannya jelas tidak aktif.
- User mendapat feedback visual yang jelas mengenai tombol yang tidak bisa digunakan.
- Endpoint API sudah diperbarui dan siap digunakan oleh back-end.

---

## Contoh Pemanggilan API (Untuk Back-End)

**Endpoint:**  
```
GET https://app.weva.my.id/api/acc-mg?id_sj={ID_SJ}&id_m={ID_MANAGER}
```

**Contoh:**  
```
GET https://app.weva.my.id/api/acc-mg?id_sj=SJ12345&id_m=MG001
```

**Response:**  
- `1` : Berhasil ACC Manager
- `0` : Gagal ACC Manager

---

**Catatan:**  
Perubahan ini memastikan hanya proses ACC Manager yang dapat dilakukan dari halaman ini, sehingga keamanan dan alur bisnis lebih terjaga. Tampilan tombol yang tidak aktif juga membantu user memahami batasan aksi yang tersedia.